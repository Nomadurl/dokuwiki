a:119:{i:0;a:3:{i:0;s:14:"document_start";i:1;a:0:{}i:2;i:0;}i:1;a:3:{i:0;s:6:"p_open";i:1;a:0:{}i:2;i:0;}i:2;a:3:{i:0;s:11:"strong_open";i:1;a:0:{}i:2;i:1;}i:3;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:88:"Сервис проверки дополнительных условия задания";}i:2;i:3;}i:4;a:3:{i:0;s:12:"strong_close";i:1;a:0:{}i:2;i:91;}i:5;a:3:{i:0;s:9:"linebreak";i:1;a:0:{}i:2;i:93;}i:6;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:102:"
Создано в рамках задания «Дополнительные условия» WW-449.";}i:2;i:95;}i:7;a:3:{i:0;s:9:"linebreak";i:1;a:0:{}i:2;i:197;}i:8;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:62:"
Namespace: \common\services\TaskAdditionalRequirementService.";}i:2;i:199;}i:9;a:3:{i:0;s:9:"linebreak";i:1;a:0:{}i:2;i:261;}i:10;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:115:"
Принимает в качестве параметра конструктора объект класса Task.";}i:2;i:263;}i:11;a:3:{i:0;s:9:"linebreak";i:1;a:0:{}i:2;i:378;}i:12;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:286:"
Содержит переменную $errors типа массив для хранения ошибок при невыполнении дополнительных условий задания. Добавление в массив осуществляется через метод:";}i:2;i:380;}i:13;a:3:{i:0;s:9:"linebreak";i:1;a:0:{}i:2;i:666;}i:14;a:3:{i:0;s:7:"p_close";i:1;a:0:{}i:2;i:668;}i:15;a:3:{i:0;s:10:"listu_open";i:1;a:0:{}i:2;i:668;}i:16;a:3:{i:0;s:13:"listitem_open";i:1;a:1:{i:0;i:1;}i:2;i:668;}i:17;a:3:{i:0;s:16:"listcontent_open";i:1;a:0:{}i:2;i:668;}i:18;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:1:" ";}i:2;i:672;}i:19;a:3:{i:0;s:14:"monospace_open";i:1;a:0:{}i:2;i:673;}i:20;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:16:"addError(string ";}i:2;i:675;}i:21;a:3:{i:0;s:13:"emphasis_open";i:1;a:0:{}i:2;i:691;}i:22;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:4:"$key";}i:2;i:693;}i:23;a:3:{i:0;s:14:"emphasis_close";i:1;a:0:{}i:2;i:697;}i:24;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:9:", string ";}i:2;i:699;}i:25;a:3:{i:0;s:13:"emphasis_open";i:1;a:0:{}i:2;i:708;}i:26;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:6:"$value";}i:2;i:710;}i:27;a:3:{i:0;s:14:"emphasis_close";i:1;a:0:{}i:2;i:716;}i:28;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:1:")";}i:2;i:718;}i:29;a:3:{i:0;s:15:"monospace_close";i:1;a:0:{}i:2;i:719;}i:30;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:2:", ";}i:2;i:721;}i:31;a:3:{i:0;s:9:"linebreak";i:1;a:0:{}i:2;i:723;}i:32;a:3:{i:0;s:17:"listcontent_close";i:1;a:0:{}i:2;i:725;}i:33;a:3:{i:0;s:14:"listitem_close";i:1;a:0:{}i:2;i:725;}i:34;a:3:{i:0;s:11:"listu_close";i:1;a:0:{}i:2;i:725;}i:35;a:3:{i:0;s:6:"p_open";i:1;a:0:{}i:2;i:725;}i:36;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:144:"принимающий в качестве параметра строковые значения ключа и значения массива.";}i:2;i:726;}i:37;a:3:{i:0;s:9:"linebreak";i:1;a:0:{}i:2;i:870;}i:38;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:79:"
Для получения данных массива служит метод:";}i:2;i:872;}i:39;a:3:{i:0;s:9:"linebreak";i:1;a:0:{}i:2;i:951;}i:40;a:3:{i:0;s:7:"p_close";i:1;a:0:{}i:2;i:953;}i:41;a:3:{i:0;s:10:"listu_open";i:1;a:0:{}i:2;i:953;}i:42;a:3:{i:0;s:13:"listitem_open";i:1;a:1:{i:0;i:1;}i:2;i:953;}i:43;a:3:{i:0;s:16:"listcontent_open";i:1;a:0:{}i:2;i:953;}i:44;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:1:" ";}i:2;i:957;}i:45;a:3:{i:0;s:14:"monospace_open";i:1;a:0:{}i:2;i:958;}i:46;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:11:"getErrors()";}i:2;i:960;}i:47;a:3:{i:0;s:15:"monospace_close";i:1;a:0:{}i:2;i:971;}i:48;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:1:",";}i:2;i:973;}i:49;a:3:{i:0;s:9:"linebreak";i:1;a:0:{}i:2;i:974;}i:50;a:3:{i:0;s:17:"listcontent_close";i:1;a:0:{}i:2;i:976;}i:51;a:3:{i:0;s:14:"listitem_close";i:1;a:0:{}i:2;i:976;}i:52;a:3:{i:0;s:11:"listu_close";i:1;a:0:{}i:2;i:976;}i:53;a:3:{i:0;s:6:"p_open";i:1;a:0:{}i:2;i:976;}i:54;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:112:"который возвращает весь массив ошибок. Главный метод сервиса";}i:2;i:977;}i:55;a:3:{i:0;s:9:"linebreak";i:1;a:0:{}i:2;i:1089;}i:56;a:3:{i:0;s:7:"p_close";i:1;a:0:{}i:2;i:1091;}i:57;a:3:{i:0;s:10:"listu_open";i:1;a:0:{}i:2;i:1091;}i:58;a:3:{i:0;s:13:"listitem_open";i:1;a:1:{i:0;i:1;}i:2;i:1091;}i:59;a:3:{i:0;s:16:"listcontent_open";i:1;a:0:{}i:2;i:1091;}i:60;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:1:" ";}i:2;i:1095;}i:61;a:3:{i:0;s:14:"monospace_open";i:1;a:0:{}i:2;i:1096;}i:62;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:7:"check()";}i:2;i:1098;}i:63;a:3:{i:0;s:15:"monospace_close";i:1;a:0:{}i:2;i:1105;}i:64;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:1:",";}i:2;i:1107;}i:65;a:3:{i:0;s:9:"linebreak";i:1;a:0:{}i:2;i:1108;}i:66;a:3:{i:0;s:17:"listcontent_close";i:1;a:0:{}i:2;i:1110;}i:67;a:3:{i:0;s:14:"listitem_close";i:1;a:0:{}i:2;i:1110;}i:68;a:3:{i:0;s:11:"listu_close";i:1;a:0:{}i:2;i:1110;}i:69;a:3:{i:0;s:6:"p_open";i:1;a:0:{}i:2;i:1110;}i:70;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:211:"возвращает булево значение. Если после окончания вызова всех проверок массив ошибок пуст - возвращает true, иначе false.";}i:2;i:1111;}i:71;a:3:{i:0;s:9:"linebreak";i:1;a:0:{}i:2;i:1322;}i:72;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:203:"
В самом начале метод проверяет наличие дополнительных условий включенных в задание через связь у сущности Task.";}i:2;i:1324;}i:73;a:3:{i:0;s:7:"p_close";i:1;a:0:{}i:2;i:1527;}i:74;a:3:{i:0;s:10:"listu_open";i:1;a:0:{}i:2;i:1527;}i:75;a:3:{i:0;s:13:"listitem_open";i:1;a:1:{i:0;i:1;}i:2;i:1527;}i:76;a:3:{i:0;s:16:"listcontent_open";i:1;a:0:{}i:2;i:1527;}i:77;a:3:{i:0;s:14:"monospace_open";i:1;a:0:{}i:2;i:1533;}i:78;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:5:"$this";}i:2;i:1535;}i:79;a:3:{i:0;s:6:"entity";i:1;a:1:{i:0;s:2:"->";}i:2;i:1540;}i:80;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:4:"task";}i:2;i:1542;}i:81;a:3:{i:0;s:6:"entity";i:1;a:1:{i:0;s:2:"->";}i:2;i:1546;}i:82;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:22:"additionalRequirements";}i:2;i:1548;}i:83;a:3:{i:0;s:15:"monospace_close";i:1;a:0:{}i:2;i:1570;}i:84;a:3:{i:0;s:9:"linebreak";i:1;a:0:{}i:2;i:1572;}i:85;a:3:{i:0;s:17:"listcontent_close";i:1;a:0:{}i:2;i:1574;}i:86;a:3:{i:0;s:14:"listitem_close";i:1;a:0:{}i:2;i:1574;}i:87;a:3:{i:0;s:11:"listu_close";i:1;a:0:{}i:2;i:1574;}i:88;a:3:{i:0;s:6:"p_open";i:1;a:0:{}i:2;i:1574;}i:89;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:512:"Если дополнительные условия не найден сервис возвращает true. Если же у задания существуют дополнительные условия, то проверяются типы дополнительных условий для которых предусмотрена обработка. Например для проверка наличия требования фотоотчет выполняется следующим образом:";}i:2;i:1575;}i:90;a:3:{i:0;s:7:"p_close";i:1;a:0:{}i:2;i:2087;}i:91;a:3:{i:0;s:12:"preformatted";i:1;a:1:{i:0;s:471:"if (Task::find()
    ->joinWith('additionalRequirements')
    ->where('task.id = :taskId and task_additional_requirement.type = :additionalRequirementType',
     [
       ':taskId' => $this->task->id,
       ':additionalRequirementType' => TaskAdditionalRequirement::TYPE_NEED_FOTO
     ])
    ->exists()) {
      if (!$this->checkTaskPerformerFotoAttachment()) {
           $this->addError('foto', \Yii::t('app', I18nCommonApp::TASK_PERFORMER_FOTO_NOT_FOUND));
      }
}";}i:2;i:2087;}i:92;a:3:{i:0;s:6:"p_open";i:1;a:0:{}i:2;i:2087;}i:93;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:102:"Если среди дополнительных условий найдено одно с типом ";}i:2;i:2584;}i:94;a:3:{i:0;s:14:"monospace_open";i:1;a:0:{}i:2;i:2686;}i:95;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:41:"TaskAdditionalRequirement::TYPE_NEED_FOTO";}i:2;i:2688;}i:96;a:3:{i:0;s:15:"monospace_close";i:1;a:0:{}i:2;i:2729;}i:97;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:38:", то вызывается метод";}i:2;i:2731;}i:98;a:3:{i:0;s:9:"linebreak";i:1;a:0:{}i:2;i:2769;}i:99;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:1:"
";}i:2;i:2771;}i:100;a:3:{i:0;s:14:"monospace_open";i:1;a:0:{}i:2;i:2772;}i:101;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:34:"checkTaskPerformerFotoAttachment()";}i:2;i:2774;}i:102;a:3:{i:0;s:15:"monospace_close";i:1;a:0:{}i:2;i:2808;}i:103;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:103:", который возвращает булево значение. Реализация метода:";}i:2;i:2810;}i:104;a:3:{i:0;s:9:"linebreak";i:1;a:0:{}i:2;i:2913;}i:105;a:3:{i:0;s:7:"p_close";i:1;a:0:{}i:2;i:2915;}i:106;a:3:{i:0;s:12:"preformatted";i:1;a:1:{i:0;s:355:"protected function checkTaskPerformerFotoAttachment(): bool
{
  return TaskFile::find()->joinWith('file')
    ->where('task_id = :taskId', [':taskId' => $this->task->id])
    ->andWhere('owner = :fileOwner', [':fileOwner' => TaskFile::OWNER_PERFORMER])
    ->andWhere('file.type = :fileType', [':fileType' => File::TYPE_TASK_ATTACHMENT])
    ->exists();
}";}i:2;i:2915;}i:107;a:3:{i:0;s:6:"plugin";i:1;a:4:{i:0;s:12:"wrap_divwrap";i:1;a:2:{i:0;i:1;i:1;s:27:"center round important 100%";}i:2;i:1;i:3;s:34:"<WRAP center round important 100%>";}i:2;i:3288;}i:108;a:3:{i:0;s:12:"preformatted";i:1;a:1:{i:0;s:341:"При выполнении проверки на наличие файла важно чтобы файлы прикрепленные исполнителем к заданию
имели тип TaskFile::OWNER_PERFORMER равный 1. Данное значение выставляется в таблице task_file 
в поле owner.";}i:2;i:3322;}i:109;a:3:{i:0;s:6:"plugin";i:1;a:4:{i:0;s:12:"wrap_divwrap";i:1;a:2:{i:0;i:4;i:1;s:0:"";}i:2;i:4;i:3;s:7:"</WRAP>";}i:2;i:3671;}i:110;a:3:{i:0;s:6:"p_open";i:1;a:0:{}i:2;i:3671;}i:111;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:340:"Если проверка на наличие файла фототчета не прошла, то добавляем в массив ошибок новую запись, где ключом выступает причина ошибки, а значением соответствующее информативное сообщение.";}i:2;i:3680;}i:112;a:3:{i:0;s:7:"p_close";i:1;a:0:{}i:2;i:4020;}i:113;a:3:{i:0;s:6:"p_open";i:1;a:0:{}i:2;i:4020;}i:114;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:231:"После выполнения проверок происходит проверка на наличие ошибок в массиве ошибок и если ошибок нет возвращается true, иначе false.";}i:2;i:4022;}i:115;a:3:{i:0;s:7:"p_close";i:1;a:0:{}i:2;i:4253;}i:116;a:3:{i:0;s:12:"preformatted";i:1;a:1:{i:0;s:41:"if ($this->errors) {
     return false;
}";}i:2;i:4253;}i:117;a:3:{i:0;s:12:"preformatted";i:1;a:1:{i:0;s:12:"return true;";}i:2;i:4302;}i:118;a:3:{i:0;s:12:"document_end";i:1;a:0:{}i:2;i:4302;}}